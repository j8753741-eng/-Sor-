<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ma princesse ‚Äî el amor que viaja contigo</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Playfair+Display:wght@400;600&display=swap" rel="stylesheet">
<style>
  :root{
    --gold:#e6bf48;
    --cream:#f5eee8;
    --violet-a:#6f3f7a; /* √Åmsterdam (claro) */
    --violet-b:#552a6a; /* Suiza (medio) */
    --violet-c:#2f1538; /* Noruega (oscuro) */
    --surprise-bg:#0b0310;
    --glass: rgba(255,255,255,0.03);
    --flag-size:52px;
    --radius:14px;
    --fadeDur:0.55s;
  }

  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%}
  body{
    font-family:"Playfair Display", serif;
    -webkit-font-smoothing:antialiased;
    background: linear-gradient(180deg,#030014,#0b0410 60%);
    color:var(--cream);
    display:flex;
    align-items:center;
    justify-content:center;
    padding:18px;
    min-height:100vh;
  }

  /* Intro overlay */
  .intro {
    position:fixed; inset:0; z-index:40;
    display:flex; align-items:center; justify-content:center;
    background: radial-gradient(circle at 20% 20%, rgba(110,60,140,0.12), transparent 8%),
                linear-gradient(180deg, rgba(3,1,10,0.88), rgba(0,0,0,0.9));
    flex-direction:column; gap:14px;
    text-align:center; padding:28px;
    backdrop-filter: blur(3px);
  }
  .intro h1{
    font-family:'Great Vibes', cursive;
    color:var(--gold);
    font-size:3rem;
    text-shadow:0 0 18px rgba(230,191,72,0.18);
  }
  .intro p{ max-width:720px; color:#eadfd6; font-size:1.05rem; line-height:1.45 }
  .btn-enter{
    margin-top:6px; padding:12px 28px; border-radius:999px;
    background: linear-gradient(180deg, rgba(201,158,247,0.22), rgba(201,158,247,0.06));
    border:1px solid rgba(201,158,247,0.28);
    color:#fff; font-weight:700; cursor:pointer; box-shadow:0 10px 28px rgba(45,8,80,0.45);
    animation: floatBtn 3s ease-in-out infinite;
    transition: box-shadow .25s, transform .18s;
  }
  @keyframes floatBtn { 0%{transform:translateY(0)}50%{transform:translateY(-6px)}100%{transform:translateY(0)} }
  .btn-enter:hover{ box-shadow:0 14px 40px rgba(80,30,120,0.38); transform:translateY(-3px) }

  /* container card */
  .wrap { width:100%; max-width:980px; position:relative; z-index:10; }
  .card {
    border-radius:var(--radius);
    overflow:hidden;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.008));
    border:1px solid rgba(201,158,247,0.05);
    box-shadow: 0 22px 64px rgba(0,0,0,0.7);
  }

  /* top menu with flags (fixed relative to card) */
  .topmenu {
    display:flex; align-items:center; justify-content:space-between;
    padding:14px 18px; gap:12px; background: linear-gradient(90deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
  }
  .title { font-family:'Great Vibes', cursive; color:var(--gold); font-size:1.4rem; }
  .menu {
    display:flex; gap:10px; align-items:center;
  }
  .flag {
    width:var(--flag-size); height:var(--flag-size); border-radius:999px;
    display:inline-flex; align-items:center; justify-content:center; font-size:22px;
    cursor:pointer; background:linear-gradient(180deg, rgba(255,255,255,0.015), rgba(0,0,0,0.06));
    border:2px solid rgba(255,255,255,0.04);
    box-shadow: 0 8px 20px rgba(20,4,40,0.45);
    transition: transform .14s ease, box-shadow .14s ease;
  }
  .flag:active{ transform:translateY(2px) }
  .flag.active{ outline:3px solid rgba(201,158,247,0.18); transform:scale(1.04) }

  /* main area */
  .main {
    position:relative;
    display:flex;
    gap:18px;
    padding:22px;
    min-height:56vh;
    align-items:flex-start;
  }

  /* left content */
  .content {
    flex:1 1 700px;
    position:relative;
    z-index:5;
  }
  .panel {
    border-radius:12px;
    padding:20px;
    background:var(--glass);
    border:1px solid rgba(255,255,255,0.02);
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.02);
    min-height:40vh;
    transition: opacity var(--fadeDur) ease, transform var(--fadeDur) ease;
    opacity:0;
    transform:translateY(6px);
  }
  .panel.show { opacity:1; transform:translateY(0) }

  .country { color:var(--gold); font-weight:700; margin-bottom:10px; font-size:1.05rem; }
  .text { color:var(--cream); font-size:1.06rem; line-height:1.7; text-align:justify; white-space:pre-line; }
  .signature { text-align:right; margin-top:14px; color:var(--gold); font-family:'Great Vibes'; font-size:1.18rem }

  /* small hint */
  .hint { text-align:center; color:#dcd0c8; font-size:0.92rem; margin-top:10px; opacity:0.95 }

  /* tint backgrounds per country (low opacity) */
  .tint {
    position:absolute; inset:0; z-index:1; pointer-events:none; border-radius:0;
    transition: background var(--fadeDur) ease;
    mix-blend-mode: screen; opacity:0.22;
    background-repeat:no-repeat;
    background-position:center;
    background-size:cover;
  }

  /* specific tints */
  .t-amsterdam{ background: linear-gradient(180deg, rgba(111,63,122,0.85), rgba(39,15,38,0.85)); }
  .t-switzerland{ background: linear-gradient(180deg, rgba(85,42,106,0.86), rgba(22,9,32,0.86)); }
  .t-norway{ background: linear-gradient(180deg, rgba(47,21,56,0.88), rgba(8,3,20,0.9)); }
  .t-surprise{ background: linear-gradient(180deg, rgba(6,2,20,0.95), rgba(0,0,0,0.98)); }

  /* surprise overlay specifics (stars & typewriter) */
  .surprise-canvas { position:absolute; inset:0; z-index:1; pointer-events:none; }
  .surprise-box { position:relative; z-index:6; padding:28px; display:flex; flex-direction:column; gap:12px; align-items:center; justify-content:center; min-height:44vh; }
  .surprise-text { color:var(--cream); font-size:1.25rem; line-height:1.65; text-align:center; max-width:820px; min-height:120px; }
  .surprise-final { color:var(--gold); font-family:'Great Vibes'; font-size:1.6rem; text-align:center; margin-top:6px; }

  /* final controls */
  .controls { display:flex; gap:8px; justify-content:center; margin-top:8px; }
  .btn { padding:10px 14px; border-radius:999px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06)); border:1px solid rgba(255,255,255,0.04); cursor:pointer; color:var(--cream); }

  /* responsive */
  @media (max-width:820px){
    .main{ flex-direction:column; padding:16px; gap:14px }
    .flag{ width:44px; height:44px; font-size:18px }
    .btn-enter{ padding:10px 18px }
    .surprise-text{ font-size:1.05rem }
  }
</style>
</head>
<body>
  <!-- Intro overlay -->
  <section class="intro" id="intro">
    <h1>Bienvenida, mi compa√±era de viaje.</h1>
    <p>Mi amor.</p>
    <button class="btn-enter" id="enterBtn">Entrar</button>
  </section>

  <div class="wrap">
    <article class="card" role="main" aria-live="polite">
      <div class="topmenu">
        <div class="title">Ma princesse ‚Äî el amor que viaja contigo</div>
        <div class="menu" role="navigation" aria-label="Selecciona destino">
          <button class="flag active" data-id="0" title="√Åmsterdam">üá≥üá±</button>
          <button class="flag" data-id="1" title="Suiza">üá®üá≠</button>
          <button class="flag" data-id="2" title="Noruega">üá≥üá¥</button>
          <button class="flag" data-id="3" title="Sorpresa">‚ú®</button>
        </div>
      </div>

      <div class="main">
        <div class="tint t-amsterdam" id="tint"></div>

        <div class="content">
          <!-- Panel: Amsterdam -->
          <section class="panel" id="p-0" aria-hidden="false">
            <div class="country">√Åmsterdam ‚Äî Pa√≠ses Bajos</div>
            <div class="text" id="text-0">
              Caminamos por los canales al atardecer, y el reflejo en el agua lleva tu risa como un faro.
              Si tus pasos te llevan all√≠, ir√© contigo entre bicicletas y tulipanes; me perder√© contigo, me encontrar√© en tus manos.
              Quiero que sepas: donde t√∫ est√©s, mi hogar te sigue.
            </div>
            <div class="signature">‚Äî Con todo mi amor</div>
          </section>

          <!-- Panel: Switzerland -->
          <section class="panel" id="p-1" aria-hidden="true">
            <div class="country">Suiza ‚Äî Suiza</div>
            <div class="text" id="text-1">
              En los lagos claros y las cumbres nevadas imagino construir un refugio para nosotros.
              Te prometo calma y constancia; prometo que mi vida tendr√° la sencillez y la belleza de un amanecer alpino a tu lado.
            </div>
            <div class="signature">‚Äî Con todo mi amor</div>
          </section>

          <!-- Panel: Norway -->
          <section class="panel" id="p-2" aria-hidden="true">
            <div class="country">Noruega ‚Äî Noruega</div>
            <div class="text" id="text-2">
              Bajo auroras que pintan el cielo, te tomar√© la mano y te dir√© que no hay noche demasiado fr√≠a cuando estamos juntos.
              Si sue√±as con las luces del norte, yo so√±ar√© contigo bajo ese mismo brillo.
            </div>
            <div class="signature">‚Äî Con todo mi amor</div>
          </section>

          <!-- Panel: Surprise -->
          <section class="panel" id="p-3" aria-hidden="true" style="position:relative;">
            <div class="surprise-box">
              <!-- canvas for stars will be inserted here by JS when active -->
              <div class="surprise-text" id="surpriseText"></div>
              <div class="surprise-final" id="surpriseFinal" aria-hidden="true">
                <!-- Editable name placeholder -->
                Te amo con todo mi coraz√≥n, mi princesa <span id="princessName"> valeria Isabel petro Villaz√≥n </span>.
              </div>

              <div class="controls" id="surpriseControls" style="display:none">
                <button class="btn" id="restartBtn">Volver al inicio</button>
              </div>
            </div>
          </section>

          <div class="hint">Toca una bandera arriba para elegir un destino</div>
        </div>

      </div>

      <div style="padding:14px 18px; text-align:center;">
        <div style="color:rgba(230,191,72,0.9); font-family:'Great Vibes';">Ma princesse ‚Äî donde vayas, yo ir√© contigo.</div>
      </div>
    </article>
  </div>

<script>
/* ---------- Quick utilities ---------- */
const flags = Array.from(document.querySelectorAll('.flag'));
const panels = [document.getElementById('p-0'), document.getElementById('p-1'), document.getElementById('p-2'), document.getElementById('p-3')];
const tint = document.getElementById('tint');
const intro = document.getElementById('intro');
const enterBtn = document.getElementById('enterBtn');
const surpriseTextEl = document.getElementById('surpriseText');
const surpriseFinalEl = document.getElementById('surpriseFinal');
const restartBtn = document.getElementById('restartBtn');
const princessNameEl = document.getElementById('princessName');

let current = 0;
let typingTimer = null;
let starsCanvas = null;
let starsCtx = null;
let starsAnimId = null;

/* data for panels (for potential dynamic changes) */
const data = [
  { id:0, tintClass:'t-amsterdam' },
  { id:1, tintClass:'t-switzerland' },
  { id:2, tintClass:'t-norway' },
  { id:3, tintClass:'t-surprise' }
];

/* fade helper */
function showPanel(i){
  // hide any running surprise
  stopStars();
  clearTyping();

  panels.forEach((p,idx)=>{
    if(idx === i){
      p.classList.add('show');
      p.setAttribute('aria-hidden','false');
    } else {
      p.classList.remove('show');
      p.setAttribute('aria-hidden','true');
    }
  });
  // update tint background
  tint.className = 'tint ' + data[i].tintClass;
  // flags active
  flags.forEach(f=>f.classList.remove('active'));
  const active = flags.find(f=>parseInt(f.dataset.id,10)===i);
  if(active) active.classList.add('active');

  // if surprise -> start star animation + typewriter
  if(i === 3){
    startStars();
    playTypewriterSequence();
  } else {
    surpriseTextEl.textContent = '';
    surpriseFinalEl.style.display = 'none';
    document.getElementById('surpriseControls').style.display = 'none';
  }

  current = i;
}

/* attach flags */
flags.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const id = parseInt(btn.dataset.id,10);
    // quick fade effect: panels have show class controlling opacity
    // showPanel will set class; CSS transition handles fade
    showPanel(id);
    window.scrollTo({top:0,behavior:'smooth'});
  });
});

/* enter button */
enterBtn.addEventListener('click', ()=>{
  intro.style.display = 'none';
  showPanel(0);
});

/* restart */
restartBtn.addEventListener('click', ()=>{
  // return to intro
  intro.style.display = 'flex';
  showPanel(0);
  // reset princess placeholder if wanted (left editable in DOM)
});

/* ----------------- Surprise: typewriter & stars ----------------- */

/* typewriter text lines */
const typeLines = [
  "Y cuando llegues al final de todos nuestros destinos...",
  "", // small pause
  "Te amo con todo mi coraz√≥n, mi princesa " // name appended after typing
];

function clearTyping(){
  if(typingTimer) { clearInterval(typingTimer); typingTimer = null; }
}

/* perform letter by letter with small pauses and then reveal final line with name */
function playTypewriterSequence(){
  surpriseTextEl.textContent = '';
  surpriseFinalEl.style.display = 'none';
  document.getElementById('surpriseControls').style.display = 'none';
  // type first line
  let lineIndex = 0;
  let charIndex = 0;
  let phase = 'typing'; // typing, pause, next
  const typeSpeed = 28; // ms per char (fast but readable)
  const pauseBetweenLines = 700;

  function typeStep(){
    const line = typeLines[lineIndex];
    if(charIndex < line.length){
      surpriseTextEl.textContent += line.charAt(charIndex);
      charIndex++;
    } else {
      // finished line
      lineIndex++;
      charIndex = 0;
      if(lineIndex >= typeLines.length){
        // all typed (last is prefix for name)
        clearTyping();
        // now type name (editable)
        const namePlaceholder = princessNameEl.textContent || '[TU NOMBRE AQU√ç]';
        // show final with typing of name
        surpriseFinalEl.style.display = 'block';
        // compose base final prefix in the final element then type name
        // final element currently contains: "Te amo con todo mi coraz√≥n, mi princesa "
        const baseText = surpriseFinalEl.textContent; // full line already in DOM, will include name placeholder
        // we will replace name part with typing effect
        // find the static prefix and the span
        const prefix = "Te amo con todo mi coraz√≥n, mi princesa ";
        surpriseFinalEl.textContent = prefix;
        let nIdx = 0;
        const nTimer = setInterval(()=>{
          if(nIdx < namePlaceholder.length){
            surpriseFinalEl.textContent = prefix + namePlaceholder.charAt(nIdx);
            nIdx++;
          } else {
            clearInterval(nTimer);
            // show restart button after short pause
            setTimeout(()=>{
              document.getElementById('surpriseControls').style.display = 'flex';
            }, 450);
          }
        }, 70);
        return;
      } else {
        // small pause then continue typing next line
        surpriseTextEl.textContent += "\n\n";
        setTimeout(typeStep, pauseBetweenLines);
        return;
      }
    }
    typingTimer = setTimeout(typeStep, typeSpeed);
  }

  typeStep();
}

/* -------- Stars canvas (only for surprise) -------- */
function startStars(){
  if(starsCanvas) return; // already running
  starsCanvas = document.createElement('canvas');
  starsCanvas.className = 'surprise-canvas';
  starsCanvas.width = window.innerWidth;
  starsCanvas.height = window.innerHeight;
  const panelSurprise = document.getElementById('p-3');
  panelSurprise.insertBefore(starsCanvas, panelSurprise.firstChild);
  starsCtx = starsCanvas.getContext('2d');
  let w = starsCanvas.width, h = starsCanvas.height;
  window.addEventListener('resize', ()=> {
    if(starsCanvas){ starsCanvas.width = innerWidth; starsCanvas.height = innerHeight; }
  });

  const stars = [];
  const count = Math.max(40, Math.round((w*h)/60000));
  for(let i=0;i<count;i++){
    stars.push({
      x: Math.random()*w,
      y: Math.random()*h,
      r: Math.random()*1.6+0.3,
      vx: (Math.random()*0.6-0.3),
      vy: (Math.random()*0.1-0.05),
      a: Math.random()*0.7+0.15,
      tw: Math.random()*180
    });
  }
  function drawStars(){
    if(!starsCtx) return;
    const cw = starsCanvas.width = innerWidth;
    const ch = starsCanvas.height = innerHeight;
    starsCtx.clearRect(0,0,cw,ch);
    for(const s of stars){
      s.x += s.vx;
      s.y += s.vy;
      s.tw += 0.5;
      if(s.x < -10) s.x = cw + 10;
      if(s.x > cw + 10) s.x = -10;
      if(s.y < -10) s.y = ch + 10;
      if(s.y > ch + 10) s.y = -10;
      // glow
      const grd = starsCtx.createRadialGradient(s.x, s.y, 0, s.x, s.y, s.r*6);
      grd.addColorStop(0, 'rgba(255,255,255,' + (s.a) + ')');
      grd.addColorStop(0.6, 'rgba(207,166,246,' + (s.a*0.45) + ')');
      grd.addColorStop(1, 'rgba(0,0,0,0)');
      starsCtx.beginPath();
      starsCtx.fillStyle = grd;
      starsCtx.arc(s.x, s.y, s.r*4, 0, Math.PI*2);
      starsCtx.fill();
    }
    starsAnimId = requestAnimationFrame(drawStars);
  }
  drawStars();
}

function stopStars(){
  if(starsAnimId){ cancelAnimationFrame(starsAnimId); starsAnimId = null; }
  if(starsCanvas && starsCanvas.parentNode){
    starsCanvas.parentNode.removeChild(starsCanvas);
    starsCanvas = null; starsCtx = null;
  }
}

/* initialize first panel visible with quick fade */
window.addEventListener('load', ()=>{
  // Ensure initial visibility state
  panels.forEach((p, idx)=> {
    if(idx === 0) p.classList.add('show');
    else p.classList.remove('show');
  });
  tint.className = 'tint t-amsterdam';
});

/* keyboard nav (left/right) */
window.addEventListener('keydown', (e)=>{
  if(document.getElementById('intro') && document.getElementById('intro').style.display !== 'none') return;
  if(e.key === 'ArrowRight'){ const next = Math.min(3, current+1); flags[next].click(); }
  if(e.key === 'ArrowLeft'){ const prev = Math.max(0, current-1); flags[prev].click(); }
});

/* touch swipe navigation (optional) */
(function(){
  let sx=0, sy=0;
  document.addEventListener('touchstart', e=>{ sx = e.changedTouches[0].screenX; sy = e.changedTouches[0].screenY; }, {passive:true});
  document.addEventListener('touchend', e=>{
    const dx = e.changedTouches[0].screenX - sx;
    const dy = e.changedTouches[0].screenY - sy;
    if(Math.abs(dx) > 60 && Math.abs(dy) < 120){
      if(dx < 0) { const next = Math.min(3, current+1); flags[next].click(); }
      else { const prev = Math.max(0, current-1); flags[prev].click(); }
    }
  }, {passive:true});
})();

/* Accessibility: allow user editing of name via contenteditable on the span if they want */
princessNameEl.setAttribute('contenteditable','true');
princessNameEl.setAttribute('aria-label','Escribe aqu√≠ el nombre de tu princesa.');

// quick focus hint when contenteditable
princessNameEl.addEventListener('focus', ()=> {
  princessNameEl.style.outline = '2px dashed rgba(230,191,72,0.25)';
});
princessNameEl.addEventListener('blur', ()=> {
  princessNameEl.style.outline = 'none';
});
</script>
</body>
  </html>
